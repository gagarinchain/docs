<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Blockchain · Gagarin.network</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The Gagarin.network blockchain is in many ways similar to the blockchains in popular open networks such as Ethereum and Bitcoin. Blockchain is a sequence of blocks starting from special genesis block, every block has link to parent block and genesis block is reachable from every block through its parent recursively. Moreover every block has height such as height of parent block is less than children&#x27;s height by one, so no gaps in height is allowed in blockchain. "/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Blockchain · Gagarin.network"/><meta property="og:type" content="website"/><meta property="og:url" content="https://gagarinchain.github.io/docs/"/><meta property="og:description" content="The Gagarin.network blockchain is in many ways similar to the blockchains in popular open networks such as Ethereum and Bitcoin. Blockchain is a sequence of blocks starting from special genesis block, every block has link to parent block and genesis block is reachable from every block through its parent recursively. Moreover every block has height such as height of parent block is less than children&#x27;s height by one, so no gaps in height is allowed in blockchain. "/><meta property="og:image" content="https://gagarinchain.github.io/docs/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://gagarinchain.github.io/docs/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/docs/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/"><img class="logo" src="/docs/img/favicon.ico" alt="Gagarin.network"/><h2 class="headerTitleWithLogo">Gagarin.network</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/docs/overview" target="_self">Docs</a></li><li class=""><a href="/docs/docs/api" target="_self">API</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Docs</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Docs</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/docs/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/consensus">Hotstuff</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/docs/blockchain">Blockchain</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/encryption">This is encryption</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/networking">This is networking</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/oracles">This is oracles</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/plugins">This is plugins</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/startup">This is startup</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/transactions">Transactions</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/rollups">Rollups</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/state">Sate</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/gateway">Gateway</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/explorer">This is explorer</a></li><li class="navListItem"><a class="navItem" href="/docs/docs/future">This is future</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Blockchain</h1></header><article><div><span><p>The Gagarin.network blockchain is in many ways similar to the blockchains in popular open networks such as Ethereum and Bitcoin. Blockchain is a sequence of blocks starting from special genesis block, every block has link to parent block and genesis block is reachable from every block through its parent recursively. Moreover every block has height such as height of parent block is less than children's height by one, so no gaps in height is allowed in blockchain.</p>
<pre><code class="hljs css language-proto"><span class="hljs-class"><span class="hljs-keyword">message</span> <span class="hljs-title">BlockS</span> </span>{
    BlockHeaderS header = <span class="hljs-number">1</span>;
    QuorumCertificateS cert = <span class="hljs-number">2</span>;
    SignatureAggregateS signatureAggregate = <span class="hljs-number">3</span>;
    BlockDataS data = <span class="hljs-number">4</span>;
    <span class="hljs-keyword">repeated</span> TransactionS txs = <span class="hljs-number">5</span>;
    <span class="hljs-keyword">repeated</span> Receipt receipts = <span class="hljs-number">6</span>;
}

<span class="hljs-class"><span class="hljs-keyword">message</span> <span class="hljs-title">BlockHeaderS</span> </span>{
    <span class="hljs-built_in">bytes</span> hash = <span class="hljs-number">1</span>;
    <span class="hljs-built_in">bytes</span> parentHash = <span class="hljs-number">2</span>;
    <span class="hljs-built_in">bytes</span> qcHash = <span class="hljs-number">3</span>;
    <span class="hljs-built_in">bytes</span> dataHash = <span class="hljs-number">4</span>;
    <span class="hljs-built_in">bytes</span> txHash = <span class="hljs-number">5</span>;
    <span class="hljs-built_in">bytes</span> stateHash = <span class="hljs-number">6</span>;
    <span class="hljs-built_in">int32</span> height = <span class="hljs-number">7</span>;
    <span class="hljs-built_in">int64</span> timestamp = <span class="hljs-number">8</span>;
}
</code></pre>
<p>Although blockchain in Gagarin.network does have some differences.</p>
<p>At first, our blockchain has additional link to predecessor block, this link is formed via Quorum Certificate included in every block and is used for fast commits in blockchain. How QCs are formed and used during commit phase look in Hotstuff docs.</p>
<p>Second, our blockchain do not have reach forking, Gagarin.network tree looks more like a palm, with long committed trunk and reach crown on top of committed height. Hotstuff guarantees that there will be at least one new committed block every epoch and all concurrent forks can successfully be omitted.</p>
<p>Third, when block is committed we use aggregated signature, formed during voting for proposal with this block as cryptographic proof of block validity. With this proof we can get rid of all transaction signatures in this block, making block size less and further processing of this block faster.</p>
<h2><a class="anchor" aria-hidden="true" id="block-validation"></a><a href="#block-validation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Block validation</h2>
<blockquote>
<p>We will fill this section soon</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="synchronization-algorithm"></a><a href="#synchronization-algorithm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Synchronization algorithm</h2>
<p>When node starts or it receivs unknown block it must synchronize local blockchain and download missing blocks.
Further algorithm will describe this process in details:</p>
<ol>
<li><p>Discover current blockchain height and optionally top blockchain height from the network (via hello message)</p></li>
<li><p>Request chain chunk</p></li>
<li><p>We can receive chunk less than m+d height, it's normal. The only requirement is that we must receive correct subchain without block absence, orphans will be filtered.
If chunk is incorrect, we add ban score and retry request to other peers</p></li>
<li><p>We can receive chunk without head on height m, it is normal, since previous responser could not have this exact fork. In this case we start requesting block headers of potential fork sequentially, until we find parent in current blockchain or hit depthLimit.</p></li>
<li><p>If we received correct chunk and we are able to add it to existing chain and new chain is correct, we start to download block bodies in parallel.
It is possible not to receive arbitrary block. In this case we simply drop chunk till this height and request blocks on next height again repeating 3-4 steps
For each request we have peer group (f + 1), we send query to first one and expect to receive correct request in time. If we can't, we go to next peer in group. If we asked every peer, we report error.</p></li>
</ol>
<p>Request and response messages:</p>
<pre><code class="hljs css language-golang">BlockHeadersRequest {
  low: m
  high: m + d
}
</code></pre>
<pre><code class="hljs css language-golang">BlockHeadersResponse{
  headers []*BlockHeader
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/docs/consensus"><span class="arrow-prev">← </span><span>Hotstuff</span></a><a class="docs-next button" href="/docs/docs/encryption"><span>This is encryption</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#block-validation">Block validation</a></li><li><a href="#synchronization-algorithm">Synchronization algorithm</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/docs/" class="nav-home"><img src="/docs/img/favicon.ico" alt="Gagarin.network" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/docs/overview.html">Getting Started (or other categories)</a><a href="/docs/docs/api.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/docs/users">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/docs/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/docs/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2021 Your Name or Your Company Name</section></footer></div></body></html>